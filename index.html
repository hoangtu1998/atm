<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>Neon Heart Gallery ‚Äî Intro (repeat) ‚ûú Fan-out ‚ûú Spin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0f0820;        /* t√≠m ƒë·∫≠m */
      --bg2:#061326;        /* xanh ƒë·∫≠m */
      --pink:#ff4bd6;       /* neon h·ªìng */
      --cyan:#53e5ff;       /* neon xanh */
      --card-size: 150px;   /* k√≠ch th∆∞·ªõc ·∫£nh */
      --radius: 18px;       /* bo g√≥c ·∫£nh */
      --ringZ: 300px;       /* b√°n k√≠nh tr·ª•c Z (ƒë·ªô s√¢u 3D) */
      --spin-sec: 18s;      /* th·ªùi gian quay 1 v√≤ng */
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; overflow:hidden; color:#eaf6ff;
      font-family:Quicksand, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:
        radial-gradient(1200px 600px at 20% 30%, rgba(255,77,206,.18), transparent 60%),
        radial-gradient(1200px 600px at 80% 30%, rgba(83,229,255,.18), transparent 60%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
    }

    .stage{ position:fixed; inset:0; display:grid; place-items:center; perspective:1200px; }

    /* SVG tr√°i tim neon (to + s·∫Øc) */
    .neon-layer{ position:absolute; inset:0; pointer-events:none }
    /* svg{ position:absolute; width:min(96vmin, 900px); height:auto; left:50%; top:25%; transform:translateX(-50%) } */
    svg{ position:absolute; width:min(98vmin, 1000px); height:auto; left:50%; top:8%; transform:translateX(-50%) }
    /* LED ƒëu·ªïi 1 chi·ªÅu nh∆∞ v·∫Ω n√©t: d√πng dashoffset t·ª´ --len v·ªÅ 0 */
   .neon{
        fill:none;
        stroke-linecap:round;
        stroke-linejoin:round;
        stroke-width:14;
        stroke-dasharray: var(--len, 2000);
        stroke-dashoffset: var(--len, 2000);
        animation: draw var(--heart-speed,1.0s) linear infinite;
        filter:none;
        }
        .pink{ stroke: var(--pink); animation-delay: 0s; }
        .cyan{ stroke: var(--cyan); animation-delay: var(--heart-speed,1.0s); } /* ch·∫°y sau n·ª≠a tr√°i */
        @keyframes draw{
        0%   { stroke-dashoffset: var(--len); }
        100% { stroke-dashoffset: 0; }
        }


    /* Intro: 1 ·∫£nh ·ªü gi·ªØa m·ªü nh∆∞ cu·ªën s√°ch */
    .intro{ position:absolute; inset:0; display:none; place-items:center; z-index:5 }
    .book{ position:relative; width:calc(var(--card-size) * 1.2); height:calc(var(--card-size) * 1.62); transform-style:preserve-3d; }
    .page{
      position:absolute; top:0; bottom:0; width:50%; border-radius:14px; overflow:hidden;
      background:#111 center/cover no-repeat; border:1px solid rgba(255,255,255,.14);
      box-shadow:0 10px 26px rgba(0,0,0,.45)
    }
    .left{ left:0; transform-origin:left; }
    .right{ right:0; transform-origin:right; }
    .intro.open .left{ animation:openLeft 1.1s ease forwards }
    .intro.open .right{ animation:openRight 1.1s ease forwards }
    @keyframes openLeft{ from{ transform:rotateY(0deg) } 60%{ transform:rotateY(-65deg) } to{ transform:rotateY(-75deg) } }
    @keyframes openRight{ from{ transform:rotateY(0deg) } 60%{ transform:rotateY(65deg) } to{ transform:rotateY(75deg) } }
    .introGlow{
      position:absolute; inset:-14px; border-radius:24px; filter:blur(18px);
      background:radial-gradient(ellipse at 50% 50%, rgba(255,75,214,.35), rgba(83,229,255,.25), transparent 70%);
      opacity:.8
    }

    /* Carousel ·∫£nh 3D ‚Äî ·∫©n ban ƒë·∫ßu ƒë·ªÉ ch·ªâ th·∫•y 1 ·∫£nh ·ªü gi·ªØa tim */
    .carousel{
      position:relative; width: calc(1px * 2 * var(--ringZ)); height:420px; transform-style:preserve-3d;
      opacity:0; pointer-events:none; transition:opacity .35s ease;
    }
    .carousel.spinning{ animation: spin var(--spin-sec) linear infinite }
    @keyframes spin{ from{ transform: rotateY(0deg) } to{ transform: rotateY(360deg) } }

    .card{
      position:absolute; left:50%; top:50%;
      width:var(--card-size); height:calc(var(--card-size) * 1.35);
      transform-style:preserve-3d; border-radius:18px; overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 8px 28px rgba(0,0,0,.45);
      transition: transform 900ms cubic-bezier(.2,.7,.2,1)
    }
    .img{ position:absolute; inset:0; background:#111 center/cover no-repeat; box-shadow: inset 0 0 20px rgba(255,255,255,.08) }
    .glow-pink{ box-shadow: 0 8px 28px rgba(0,0,0,.45), 0 0 26px rgba(255,75,214,.35) }
    .glow-cyan{ box-shadow: 0 8px 28px rgba(0,0,0,.45), 0 0 26px rgba(83,229,255,.35) }
    .pulse{ animation:pulse 2.4s ease-in-out infinite }
    @keyframes pulse{ 0%,100%{ filter: drop-shadow(0 0 10px rgba(255,255,255,.2)) } 50%{ filter: drop-shadow(0 0 22px rgba(255,255,255,.45)) } }

    /* LED RGB ch·∫°y ƒë√°y ‚Äî nhanh h∆°n */
    .led{
      position:fixed; left:50%; transform:translateX(-50%); bottom:28px;
      width:82vw; max-width:720px; height:8px; border-radius:999px;
      background:linear-gradient(90deg, red, orange, yellow, green, cyan, blue, magenta, red);
      background-size:300% 100%;
      animation:flow 1.2s linear infinite; /* nhanh h∆°n */
      box-shadow:0 0 20px rgba(255,255,255,.35); border:1px solid rgba(255,255,255,.2)
    }
    @keyframes flow{ from{ background-position:0 0 } to{ background-position:300% 0 } }

    .caption{ position:fixed; left:50%; transform:translateX(-50%); bottom:50px; color:#eaf6ff; font-weight:700; text-shadow: 0 2px 6px rgba(0,0,0,.6)}
    .caption small{font-weight:600; opacity:.92}
  </style>
</head>
<body>
  <div class="stage">
    <!-- Tr√°i tim neon LED v·∫Ω 1 chi·ªÅu -->
    <div class="neon-layer">
      <svg viewBox="0 0 800 600" aria-hidden="true">
        <!-- Path tr√°i tim chia 2 n·ª≠a (ƒë·∫πp ‚Äì c√¢n) -->
        <!-- n·ª≠a tr√°i: t·ª´ ƒê√ÅY (400,540) ƒëi l√™n ƒê·ªàNH (400,210) -->
<path class="neon pink"
      d="M400 540 C 340 500, 230 420, 170 300 C 110 180, 290 80, 400 210"/>
<!-- n·ª≠a ph·∫£i: t·ª´ ƒê·ªàNH xu·ªëng ƒê√ÅY (gi·ªØ nguy√™n) -->
<path class="neon cyan"
      d="M400 210 C 510 80, 690 170, 630 300 C 570 420, 460 500, 400 540"/>
      </svg>
    </div>

    <!-- INTRO: 1 ·∫£nh ·ªü gi·ªØa (m·ªü nh∆∞ cu·ªën s√°ch) -->
    <div class="intro" id="intro">
      <div class="book">
        <div class="introGlow"></div>
        <!-- D√πng c√πng 1 h√¨nh cho c·∫£ 2 n·ª≠a ƒë·ªÉ tr√¥ng nh∆∞ 1 ·∫£nh duy nh·∫•t -->
        <div class="page left"></div>
        <div class="page right"></div>
      </div>
    </div>

    <!-- V√≤ng xoay ·∫£nh 3D -->
    <div class="carousel" id="carousel">
      <!-- 6 ·∫£nh quanh tr·ª•c, chia ƒë·ªÅu 360deg -->
      <div class="card glow-pink" data-angle="0"><div class="img" style="background-image:url('https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?q=80&w=600&auto=format&fit=crop')"></div></div>
      <div class="card glow-cyan" data-angle="60"><div class="img" style="background-image:url('https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?q=80&w=600&auto=format&fit=crop')"></div></div>
      <div class="card pulse" data-angle="120"><div class="img" style="background-image:url('https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=600&auto=format&fit=crop')"></div></div>
      <div class="card glow-pink" data-angle="180"><div class="img" style="background-image:url('https://images.unsplash.com/photo-1524504388940-b1c1722653e1?q=80&w=600&auto=format&fit=crop')"></div></div>
      <div class="card glow-cyan" data-angle="240"><div class="img" style="background-image:url('https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=600&auto=format&fit=crop')"></div></div>
      <div class="card" data-angle="300"><div class="img" style="background-image:url('https://images.unsplash.com/photo-1531123897727-8f129e1688ce?q=80&w=600&auto=format&fit=crop')"></div></div>
    </div>

    <div class="caption">C√≥ ny h·ªçc engineering ƒë·ªÉ l√†m g√¨ <small>ü•∫ü•∞</small></div>
    <div class="led"></div>
  </div>

  <script>
    // ===== Setup: ƒëo chi·ªÅu d√†i path ƒë·ªÉ v·∫Ω n√©t 1 chi·ªÅu m∆∞·ª£t =====
    const neonPaths = document.querySelectorAll('.neon-layer path.neon');
    neonPaths.forEach(p=>{
      const L = Math.ceil(p.getTotalLength());
      p.style.setProperty('--len', L);
      p.style.strokeDasharray  = L;
      p.style.strokeDashoffset = L;
    });

    // ===== Ch·ªçn ph·∫ßn t·ª≠ ch√≠nh =====
    const intro    = document.getElementById('intro');
    const bookLeft = intro.querySelector('.page.left');
    const bookRight= intro.querySelector('.page.right');

    const carousel = document.getElementById('carousel');
    const cards    = [...carousel.querySelectorAll('.card')];

    // L·∫•y list ·∫£nh t·ª´ c√°c card ƒë·ªÉ d√πng cho intro
    const imgs = cards.map(c => {
      const bg = c.querySelector('.img').style.backgroundImage || '';
      return bg.replace(/^url\(["']?/, '').replace(/["']?\)$/, '');
    });
    // Preload helper ƒë·ªÉ tr√°nh hi·ªán 2 trang ƒëen
    function preload(url){
    return new Promise((resolve,reject)=>{
        if(!url){ reject('no-url'); return; }
        const im = new Image();
        im.onload  = ()=> resolve(url);
        im.onerror = ()=> reject('load-fail');
        im.src = url;
    });
    }

    // ===== 1) Thu t·∫•t c·∫£ ·∫£nh v·ªÅ gi·ªØa (tr∆∞·ªõc khi bung) =====
    function centerAll(){
      cards.forEach(c=>{
        c.style.transitionTimingFunction = 'cubic-bezier(.2,.7,.2,1)';
        c.style.transform = 'translate(-50%, -50%) translateZ(0px) rotateY(0deg) scale(.9)';
      });
      // ·∫®n carousel l√∫c ƒë·∫ßu ƒë·ªÉ kh√¥ng l·ªô 3 ·∫£nh
      carousel.style.opacity = '0';
      carousel.style.pointerEvents = 'none';
    }

    // ===== 2) Bung ra ‚Äúlia b√†i‚Äù (stagger) theo data-angle =====
    function fanOut(){
      const ring = getComputedStyle(document.documentElement).getPropertyValue('--ringZ').trim();
      cards.forEach((c, idx)=>{
        const angle = +c.dataset.angle || (idx * (360/cards.length));
        c.style.transitionTimingFunction = 'cubic-bezier(.18,.88,.18,1)';
        setTimeout(()=>{
          c.style.transform = `translate(-50%, -50%) rotateY(${angle}deg) translateZ(${ring}) rotateX(-6deg)`;
        }, idx * 140); // lia b√†i t·ª´ng t·∫•m
      });

      // hi·ªán carousel sau khi lia xong
      const liaDuration = 140 * cards.length + 400;
setTimeout(()=>{
  carousel.style.opacity = '1';
  carousel.style.pointerEvents = 'auto';
  startSpin(); // bung xong l√† xoay
}, liaDuration);

    }

    // ===== 3) Quay v√≤ng =====
    function startSpin(){ carousel.classList.add('spinning'); }

    // ƒê·ªïi ·∫£nh intro (2 n·ª≠a d√πng c√πng 1 ·∫£nh => nh√¨n nh∆∞ 1 ·∫£nh duy nh·∫•t)
    function setIntroImage(url){
      const bg = `url(${url})`;
      bookLeft.style.backgroundImage  = bg;
      bookRight.style.backgroundImage = bg;
    }

    // ===== Intro loop: 1 ·∫£nh gi·ªØa tim ‚Üí (d·ª´ng 1s) ‚Üí m·ªü s√°ch ‚Üí lia b√†i ‚Üí thu v·ªÅ ‚Üí l·∫∑p =====
    function playIntroLoop(times = 3, pauseCenterMs = 1000){
  if(!imgs.length){                      // kh√¥ng c√≥ ·∫£nh -> b·ªè intro
    fanOut(); setTimeout(startSpin, 600);
    return;
  }
  let i = 0;
  const oneCycle = ()=>{
    centerAll();
    const url = imgs[i % imgs.length] || imgs[0];

    // Ch·ªâ show intro sau khi ·∫£nh ƒë√£ t·∫£i xong
    preload(url).then(()=>{
      setIntroImage(url);
      intro.style.display = 'grid';
      intro.style.opacity = '1';

      setTimeout(()=>{                          // d·ª´ng gi·ªØa tim
        intro.classList.add('open');            // m·ªü s√°ch
        setTimeout(()=>{                        // xong m·ªü s√°ch
          intro.style.opacity = '0';
          intro.style.transition = 'opacity .35s ease';
          setTimeout(()=>{ intro.style.display = 'none'; }, 360);

          fanOut();                             // lia b√†i
          const liaDuration = 140 * cards.length + 600;
          setTimeout(()=>{
            centerAll();
            intro.classList.remove('open');
            i++;
            if(i < times) setTimeout(oneCycle, 700);
            else          setTimeout(startSpin, 600);   // xoay
          }, liaDuration);
        }, 1100);
      }, pauseCenterMs);
    }).catch(()=>{                               // l·ªói t·∫£i ·∫£nh -> b·ªè intro v√≤ng n√†y
      fanOut(); setTimeout(startSpin, 600);
    });
  };
  oneCycle();
}


    // ===== Kh·ªüi ch·∫°y =====
    window.addEventListener('load', ()=>{
  fanOut();
  setTimeout(startSpin, 600);
});
  </script>
</body>
</html>

